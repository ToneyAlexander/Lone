<!DOCTYPE html>
<html>
<head>
	<style>
	* { margin:0; padding:0; }
	/* to remove the top and left whitespace */

	html, body { width:100%; height:100%; }
	/* just to be sure these are full screen*/

	canvas { display:block; }
	/* To remove the scrollbars */
</style>
</head>
<body>

	<canvas id="lone">
		Your browser does not support the HTML5 canvas tag.
	</canvas>

	<script>
		var dancers = [];
		const SPEED = 5;
		function Pair(x, y){
			this.x = x;
			this.y = y;
		}
		function Dancer(x, y, velocity){
			this.pos = new Pair(x, y);
			//Add velocity field
			this.velocity = velocity;
		}

		function init(){
			var canvas = document.getElementById('lone'),
			context = canvas.getContext('2d');

	    	// resize the canvas to fill browser window dynamically
	    	window.addEventListener('resize', resizeCanvas, false);
	    	resizeCanvas();

	    	w = window.innerWidth;
	    	h = window.innerHeight;
	    	for(c = 0; c < 25; c++){
	    		dancers.push(new Dancer(w*Math.random(), h*Math.random(), circle));
	    	}

	    	//FIX ME
	    	function centralTendency(x, y, dx, dy){
	    		var p = new Pair(window.innerWidth/2, window.innerHeight/2);
	    		var radius = Math.pow(x-p.x, 2) + Math.pow(y-p.y, 2) - 10000;

	    		if(radius > 0){
	    			if(x < p.x){
	    				dx += 2*dx*Math.random();
	    			}else{
	    				dx -= 2*dx*Math.random();
	    			}
	    			if(y < p.y){
	    				dy += 2*dy*Math.random();
	    			}else{
	    				dy -= 2*dy*Math.random();
	    			}
	    		}
	    		return new Pair(dx, dy);
	    	}

	    	function circle(x, y, t){
	    		//Create factor to randomly tend towards center
	    		dx = 1;// 10*Math.cos(t*.05);
	    		dy = 1;//10*Math.sin(t*.05);

	    		var p = centralTendency(x, y, dx, dy);
	    		dx = p.x;
	    		dy = p.y;

	    		dx2 = Math.pow(dx, 2);
	    		dy2 = Math.pow(dy, 2);

	    		scale = SPEED/Math.pow(dx2 + dy2, .5);

	    		console.log(dx2 + " " + dy2);

	    		/* dx^2 + dy^2 = 25*/
	    		console.log(Math.pow(dx*scale, 2) + Math.pow(dy*scale, 2));
	        	return new Pair(x + dx*scale, y + dy*scale);
	        }

	        function resizeCanvas() {
	        	canvas.width = window.innerWidth;
	        	canvas.height = window.innerHeight;
	        	draw(); 
	        }
	    }

	    init();
	    var t = 0;
	    var mainloop = function(){
	    	update(t);
	    	draw();
	    	t++;
	    };
	    setInterval(mainloop, 16);

	    function update(t){
	    	for(c = 0; c < dancers.length; c++){
	    		var d = dancers[c];
	    		d.pos = d.velocity(d.pos.x, d.pos.y, t);
	    	}
	    }

	    function draw() {
	    	var c = document.getElementById("lone");
	    	var ctx = c.getContext("2d");
	    	w = window.innerWidth;
	    	h = window.innerHeight;

	    	drawBG(ctx, w, h);

	    	for(c = 0; c < dancers.length; c++){
	    		ctx.beginPath();
	    		ctx.arc(dancers[c].pos.x, dancers[c].pos.y, 2, 0, 2*Math.PI);
	    		ctx.stroke();
	    	}
	    }

	    function drawBG(ctx, w, h){
			// Create gradient
			var grd = ctx.createRadialGradient(w/2,h/2,100, w/2,h/2, 800);
			grd.addColorStop(0,"white");
			grd.addColorStop(1,"lightgray");

			// Fill with gradient
			ctx.fillStyle = grd;
			ctx.fillRect(0,0,w,h);
		}

		</script>

	</body>
	</html>

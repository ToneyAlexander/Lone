<!DOCTYPE html>
<html>
<head>
	<style>
	* { margin:0; padding:0; }
	/* to remove the top and left whitespace */
	html, body { width:100%; height:100%; }
	/* just to be sure these are full screen*/
	canvas { display:block; }
	/* To remove the scrollbars */
</style>
</head>
<body>

	<canvas id="lone">
		Your browser does not support the HTML5 canvas tag.
	</canvas>

	<script>
		var dancers = [];
		const SPEED = 5;
		function Pair(x, y){
			this.x = x;
			this.y = y;
		}
		//Creative individuas, periodically request inspiration from nearby, replace nodes, take error calculation, test values in network - makes query to the world
		function Dancer(x, y, motion){
			this.pos = new Pair(x, y);
			this.vel = new Pair(.5, .5);
			this.motion = motion;
		}
		function init(){
			var canvas = document.getElementById('lone'),
			context = canvas.getContext('2d');
	    	// resize the canvas to fill browser window dynamically
	    	window.addEventListener('resize', resizeCanvas, false);
	    	resizeCanvas();
	    	w = window.innerWidth;
	    	h = window.innerHeight;
	    	for(c = 0; c < 1; c++){
	    		dancers.push(new Dancer(w*Math.random(), h*Math.random(), drift));
	    	}
	    	//FIX ME
	    	function centralTendency(x, y, dx, dy){
	    		var p = new Pair(window.innerWidth/2, window.innerHeight/2);
	    		var radius = Math.pow(x-p.x, 2) + Math.pow(y-p.y, 2) - 10000;
	    		console.log(radius);
	    		if(radius > 0){
	    			var rndx = Math.random();
	    			var rndy = Math.random();
	    			if(x < p.x){
	    				dx += 2*dx*rndx;
	    			}else{
	    				dx -= 2*dx*rndx;
	    			}
	    			if(y < p.y){
	    				dy += 2*dy*rndy;
	    			}else{
	    				dy -= 2*dy*rndy;
	    			}
	    		}
	    		return new Pair(dx, dy);
	    	}
	    	function circle(x, y, t){
	    		//Create factor to randomly tend towards center
	    		dx = 10*Math.cos(t);
	    		dy = 10*Math.sin(t);
	    		var p = centralTendency(x, y, dx, dy);
	    		dx = p.x;
	    		dy = p.y;
	    		dx2 = Math.pow(dx, 2);
	    		dy2 = Math.pow(dy, 2);
	    		scale = SPEED/Math.pow(dx2 + dy2, .5);
	    		console.log("!" + dx2 + " " + dy2);
	    		/* dx^2 + dy^2 = 25*/
	    		console.log("!" + Math.pow(dx*scale, 2) + Math.pow(dy*scale, 2));
	        	return new Pair(x + dx*scale, y + dy*scale);
	        }

	        function drift(x, y, dx0, dy0, t){
	        	dx = 2*Math.random()-1;
	        	dy = 2*Math.random()-1;
	        	//Average with old velocities
	        	//Give linked list of memory! older = less remember (.5* + .25* + ... etc. )
	        	dx = (dx + .5*dx0)/ 2;
	        	dy = (dy + .5*dy0)/ 2;

	        	if(x < 10){
	        		dx = 1;
	        	}else if (x > window.innerWidth - 10){
	        		dx = -1;
	        	}
	        	if(y < 10){
	        		dy = 1;
	        	}else if (y > window.innerHeight - 10){
	        		dy = -1;
	        	}

	        	dx2 = Math.pow(dx, 2);
	    		dy2 = Math.pow(dy, 2);
	    		scale = SPEED/Math.pow(dx2 + dy2, .5);

	    		return new Pair(new Pair(x + dx*scale, y + dy*scale), new Pair(dx*scale, dy*scale));
	        }

	        function resizeCanvas() {
	        	canvas.width = window.innerWidth;
	        	canvas.height = window.innerHeight;
	        	draw(); 
	        }
	    }
	    init();
	    var t = 0;
	    var mainloop = function(){
	    	update(t);
	    	draw();
	    	t++;
	    };
	    //16 normally
	    setInterval(mainloop, 16);
	    function update(t){
	    	for(c = 0; c < dancers.length; c++){
	    		var d = dancers[c];
	    		var res = d.motion(d.pos.x, d.pos.y, d.vel.x, d.vel.y, t);
	    		d.pos = res.x;
	    		d.vel = res.y;
	    	}
	    }
	    function draw() {
	    	var c = document.getElementById("lone");
	    	var ctx = c.getContext("2d");
	    	w = window.innerWidth;
	    	h = window.innerHeight;
	    	drawBG(ctx, w, h);
	    	for(c = 0; c < dancers.length; c++){
	    		ctx.beginPath();
	    		ctx.arc(dancers[c].pos.x, dancers[c].pos.y, 2, 0, 2*Math.PI);
	    		ctx.stroke();
	    	}
	    }
	    function drawBG(ctx, w, h){
			// Create gradient
			var grd = ctx.createRadialGradient(w/2,h/2,100, w/2,h/2, 800);
			grd.addColorStop(0,"white");
			grd.addColorStop(1,"lightgray");
			// Fill with gradient
			ctx.fillStyle = grd;
			ctx.fillRect(0,0,w,h);
		}
		</script>

	</body>
	</html>
